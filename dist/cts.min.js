!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.CTS=b()}(this,function(){"use strict";var a=function(){return{}};return new a}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){var b=function(b,c,d){var e;if(void 0===typeof d&&(d={}),"undefined"==typeof d.type&&(d.type="text/xml"),"undefined"==typeof d.async&&(d.async=!0),window&&window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window||!window.ActiveXObject)return null;var f,g;if(window.ActiveXObject){f=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(g in f)try{return new ActiveXObject(f[g])}catch(h){}}}try{e.open(b,c,d.async),e.onerror=function(){"function"==typeof d.error&&d.error(e.status,e.statusText)},e.onreadystatechange=function(){if(500===e.status||401===e.status||403===e.status||404===e.status||400===e.status)"function"==typeof d.error&&d.error(e.status,e.statusText);else if(4===e.readyState&&"function"==typeof d.success)if("text/xml"===d.type)if(null!==e.responseXML&&e.responseXML.innerHtml)try{{(new DOMParser).parseFromString(e.responseText,"text/xml")}}catch(a){d.error(a)}else d.success(e.responseXML);else("text"===d.type||"plain/text"===d.type||"text/plain"===d.type)&&d.success(e.responseText)},"undefined"==typeof d.data&&null===d.data||"POST"!==b?e.send():(e.overrideMimeType("multipart/form-data"),e.setRequestHeader("Content-type","application/x-www-form-urlencoded;"),e.send(a.utils.dataEncode(d.data)))}catch(i){"function"==typeof d.error&&d.error(i)}},c=function(b){return"string"==typeof b?new a.endpoint["default"](b):b instanceof Object?b:null},d=function(a){var b="",c=[];return Object.keys(a).forEach(function(b){Array.isArray(a[b])?a[b].forEach(function(a){c.push(encodeURIComponent(b)+"[]="+encodeURIComponent(a))}):c.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]))}),b=c.join("&").replace(/%20/g,"+")},e=function(a){if("string"==typeof a)var b=a.toLowerCase().match("[a-z]{1}");if(isNaN(a)){if(null!==b&&b[0].length===a.length){var c={a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9,j:10,k:11,l:12,m:13,n:14,o:15,p:16,q:17,r:18,s:19,t:20,u:21,v:22,w:23,x:24,y:25,z:26};return c[a]}var d=a.toLowerCase().match("([0-9]*)([a-z]*)([0-9]*)([a-z]*)([0-9]*)");if(null===d)return 0;for(var d=d.map(function(b){return b.length>0&&b!=a?b:void 0}),e=[],f=0;f<d.length;f++)d[f]&&e.push(d[f]);return e}return parseInt(a)},f=function(b,c){for(var d,e,f=!1,g=0;g<=c.length-1;g++){var d=a.utils.parseInt(b[g]),e=a.utils.parseInt(c[g]);if(Array.isArray(d)&&Array.isArray(e)){if(f=a.utils.validPassage(d,e),f===!0)break}else{if(e>d){f=!0;break}if(d>e)break}}return f},g=function(){var a={},b=window.location.search.split(/\?|\&/);return b.forEach(function(b){if(b){var c=b.split("=");a[c[0]]=c[1]}}),a};a.utils={xhr:b,dataEncode:d,checkEndpoint:c,parseInt:e,validPassage:f,uriParam:g}}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.service={services:{}};var b=function(a,b){this.options[a].value=b},c=function(){var a={},b=this;return Object.keys(b.options).forEach(function(c){a[c]="undefined"!=typeof b.options[c].value?b.options[c].value:b.options[c]["default"]}),a},d=function(){return this.options},e=function(b,c){"undefined"==typeof c&&(c="text/xml"),a.utils.xhr(this.method,this.endpoint,{success:function(a){"function"==typeof b&&b(a)},type:c,data:this.getValues()})};a.service._service=function(a){this.endpoint=a,this.method="GET",this.options={},this.setValue=b,this.getValues=c,this.getOptions=d,this.send=e},a.service._service.prototype.toString=function(){return"[object CTS.Service]"},a.service["new"]=function(a,b,c){if("string"==typeof a){if(a in this.services)return new this.services[a](b,c);throw a+" is Unknown."}}}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.xslt={},a.xslt.stylesheets={};var b=function(a){"string"==typeof a&&(a=(new DOMParser).parseFromString(a,"text/xml"));var b=new XSLTProcessor;return b.importStylesheet(a),this.processor=b,b},c=function(){var a=this.endpoint,b=new XMLHttpRequest;if(b.overrideMimeType&&b.overrideMimeType("text/xml"),b.open("GET",a,!1),b.send(null),200!=b.status)throw"Can't get transform at "+a;return this.stylesheeting(b.responseXML)},d=function(a,b){this.options[a].value=b},e=function(){var a,b={},c=this;return Object.keys(c.options).forEach(function(d){a="function"==typeof c.options[d]["default"]?c.options[d]["default"]():c.options[d]["default"],b[d]="undefined"!=typeof c.options[d].value?c.options[d].value:a}),b},f=function(){return this.options},g=function(a){var b,c,d;return this.processor||this.load(),d=this.processor,"string"==typeof a&&(a=(new DOMParser).parseFromString(a,"text/xml")),c=this.getValues(),Object.keys(c).forEach(function(a){d.setParameter(null,a,c[a])}),b=d.transformToDocument(a)};a.xslt.XSLT=function(a){this.endpoint=a,this.processor=null,this.setValue=d,this.getValues=e,this.getOptions=f,this.transform=g,this.stylesheeting=b,this.load=c},a.xslt.XSLT.prototype.toString=function(){return"[object CTS.XSLT]"},a.xslt["new"]=function(a,b,c){if("string"==typeof a){if(a in this.stylesheets)return new this.stylesheets[a](b,c);throw a+" is Unknown."}throw"@param xslt is not a string"},a.xslt.register=function(b,c){var d=function(){a.xslt.XSLT.call(this),this.options=c};return d.prototype=Object.create(a.xslt.XSLT),a.xslt.stylesheets[b]=d,a.xslt.stylesheets[b]}}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.endpoint={},a.endpoint.Endpoint=function(b,c){this.url=b,this.inventory="undefined"!=typeof c?c:null,this.getCapabilitiesURL=function(){throw"Unsupported request"},this.getDescriptionURL=function(){throw"Unsupported request"},this.getPrevNextUrnURL=function(){throw"Unsupported request"},this.getLabelURL=function(){throw"Unsupported request"},this.getValidReffURL=function(){throw"Unsupported request"},this.getPassageURL=function(){throw"Unsupported request"},this.getPassagePlusURL=function(){throw"Unsupported request"},this.getCapabilities=function(){throw"Unsupported request"},this.getDescription=function(){throw"Unsupported request"},this.getPrevNextUrn=function(){throw"Unsupported request"},this.getValidReff=function(){throw"Unsupported request"},this.getPassage=function(){throw"Unsupported request"},this.getPassagePlus=function(){throw"Unsupported request"},this.GetFirstPassagePlus=function(){throw"Unsupported request"},this.getLabel=function(){throw"Unsupported request"},this.getRequest=function(b,c){a.utils.xhr("GET",b,{success:c.success,error:c.error,type:c.type})},this.postRequest=function(b,c){a.utils.xhr("POST",b,{success:c.success,error:c.error,data:c.data,type:c.type})}},a.endpoint.Endpoint.prototype=Object.create(a.endpoint.Endpoint),a.endpoint.XQ=function(b,c){a.endpoint.Endpoint.call(this),"?"!==b.slice(-1)&&(b+="?"),this.url=b,this.inventory="undefined"!=typeof c?c:null,this.getUrl=function(a){var b=[];return Object.keys(a).forEach(function(c){b.push(c+"="+a[c])}),this.url+b.join("&")},this.getCapabilitiesURL=function(a){var b={request:"GetCapabilities"};return("undefined"!=typeof a&&null!==a||null!==this.inventory)&&(b.inv="undefined"!=typeof a&&null!==a?a:this.inventory),this.getUrl(b)},this.getCapabilities=function(a,b){"string"!=typeof a&&(b=a,a=null),this.getRequest(this.getCapabilitiesURL(a),b)},this.getPassagePlusURL=function(a,b){var c={request:"GetPassagePlus",urn:a};return("undefined"!=typeof b&&null!==b||null!==this.inventory)&&(c.inv="undefined"!=typeof b&&null!==b?b:this.inventory),this.getUrl(c)},this.getPassagePlus=function(a,b){"undefined"==typeof b&&(b={}),this.getRequest(this.getPassagePlusURL(a,b.inventory),b)},this.getPassageURL=function(a,b){var c={request:"GetPassage",urn:a};return("undefined"!=typeof b&&null!==b||null!==this.inventory)&&(c.inv="undefined"!=typeof b&&null!==b?b:this.inventory),this.getUrl(c)},this.getPassage=function(a,b){"undefined"==typeof b&&(b={}),this.getRequest(this.getPassageURL(a,b.inventory),b)},this.getValidReffURL=function(a,b){var c={request:"GetValidReff",urn:a};return"undefined"==typeof b&&(b={}),"undefined"!=typeof b.level&&(c.level=b.level),("undefined"!=typeof b.inventory&&null!==b.inventory||null!==this.inventory)&&(c.inv="undefined"!=typeof b.inventory&&null!==b.inventory?b.inventory:this.inventory),this.getUrl(c)},this.getFirstPassagePlusURL=function(a,b){var c={request:"GetFirstPassagePlus",urn:a};return"undefined"==typeof b&&(b={}),("undefined"!=typeof b.inventory&&null!==b.inventory||null!==this.inventory)&&(c.inv="undefined"!=typeof b.inventory&&null!==b.inventory?b.inventory:this.inventory),this.getUrl(c)},this.getFirstPassagePlus=function(a,b){"undefined"==typeof b&&(b={}),this.getRequest(this.getFirstPassagePlusURL(a,b),b)},this.getValidReff=function(a,b){"undefined"==typeof b&&(b={}),this.getRequest(this.getValidReffURL(a,b),b)},this.getLabelURL=function(a,b){var c={request:"GetLabel",urn:a};return("undefined"!=typeof b&&null!==b||null!==this.inventory)&&(c.inv="undefined"!=typeof b&&null!==b?b:this.inventory),this.getUrl(c)},this.getLabel=function(a,b){"undefined"==typeof b&&(b={}),this.getRequest(this.getLabelURL(a,b.inventory),b)}},a.endpoint.XQ.prototype=Object.create(a.endpoint.Endpoint),a.endpoint["default"]=a.endpoint.XQ}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){var b=function(a){for(var b=a.getElementsByTagNameNS("*","groupname"),c=a.getElementsByTagNameNS("*","title"),d=b.length-1;d>=0;d--)this.textgroup[b[d].getAttribute("xml:lang")]=b[d].textContent;for(var d=c.length-1;d>=0;d--)this.title[c[d].getAttribute("xml:lang")]=c[d].textContent};a.text={};var c=function(a){return a.replace(/(\r\n|\n|\r)/gm,"").replace(/\s+/gm," ").replace(/^\s+/,"")},d=function(a,b){var d,e=this.document;return null!==this.text?d=b===!0?c(this.text):this.text:(("undefined"==typeof a||null===a)&&(a=["note","bibl","head"]),a.forEach(function(a){for(var b=e.getElementsByTagNameNS("*",a);b[0];)b[0].parentNode.removeChild(b[0])}),d=(e.getElementsByTagNameNS("*","text")[0]||e.getElementsByTagNameNS("*","body")[0]).textContent,b===!0?c(d):d)},e=function(a){this.text=a},f=function(c){var d=this;"undefined"==typeof c&&(c={}),endpoint="undefined"==typeof c.endpoint?this.endpoint:a.utils.checkEndpoint(c.endpoint);var e=c.metadata===!0?endpoint.getPassagePlus:endpoint.getPassage;d.Text=new a.text.Text(d.urn,d.inventory),e.call(endpoint,this.urn,{inventory:this.inventory,success:function(a){d.xml=a,d.document=(new DOMParser).parseFromString(a,"text/xml"),c.metadata===!0&&b.call(d.Text,d.document),"function"==typeof c.success&&c.success(a)},type:"plain/text",error:c.error})},g=function(){var a,b=this;try{return a=b.getXml("body"),0===a[0].childNodes.length?!1:!0}catch(c){return!1}},h=function(a,b){var c,d=this,e=!1;if(("string"!=typeof b||"xml"!==b&&"string"!==b)&&(b="xml"),"string"!=typeof a?c=d.document:(c=d.document.getElementsByTagNameNS("*",a),e=!0),"string"===b){var f=new XMLSerializer;return e===!0?[].map.call(c,function(a){return f.serializeToString(a)}).join("\n"):f.serializeToString(c)}return c};a.text.Passage=function(b,c,i){"string"!=typeof i&&(i=null),this.document=null,this.xml=null,this.text=null,this.urn=b,this.inventory=i,this.endpoint=a.utils.checkEndpoint(c),this.retrieve=f,this.setText=e,this.getText=d,this.getXml=h,this.checkXML=g},a.text.Text=function(c,d,e){"string"!=typeof e&&(e=null),this.urn=c.split(":").slice(0,4).join(":"),this.inventory=e,this.endpoint=a.utils.checkEndpoint(d),this.reffs={},this.validReffs={},this.passages={},this.title={},this.textgroup={},this.getTitle=function(a){var b=this,c=Object.keys(b.title);if(0===c.length)throw new Error("No title are available");return"undefined"==typeof a||"undefined"==typeof c[a]?b.title[c[0]]:b.title[a]},this.getTextgroup=function(a){var b=this,c=Object.keys(b.textgroup);if(0===c.length)throw new Error("No textgroup are available");return"undefined"==typeof a||"undefined"==typeof c[a]?b.textgroup[c[0]]:b.textgroup[a]},this.makePassageUrn=function(a,b){if("undefined"==typeof b)var b=[];for(var c=[],d=[],e=0;e<a.length&&"undefined"!=typeof a[e];e++)(a[e].length>0||a[e]>0)&&c.push(a[e]);for(var e=0;e<b.length&&!(e>=c.length)&&"undefined"!=typeof b[e];e++)(b[e].length>0||b[e]>0)&&d.push(b[e]);var f=this.urn;return c.length>0&&(f=f+":"+c.join("."),d.length==c.length&&(f=f+"-"+d.join("."))),f},this.getPassage=function(b,c){var d=this.makePassageUrn(b,c);return this.passages[d]?this.passages[d]:(this.passages[d]=new a.text.Passage(d,this.endpoint,this.inventory),this.passages[d])},this.getFirstPassagePlus=function(b){var c=this;b.endpoint=this.endpoint,d=a.utils.checkEndpoint(b.endpoint),d.getFirstPassagePlus(this.urn,{inventory:this.inventory,success:function(d){var e=(new DOMParser).parseFromString(d,"text/xml"),f=e.getElementsByTagNameNS("http://chs.harvard.edu/xmlns/cts","urn"),g=f.length>0?f[0].textContent:e.getElementsByTagNameNS("*","current")[0].textContent;c.passages[g]=new a.text.Passage(g,c.endpoint,c.inventory),c.passages[g].document=e,"function"==typeof b.success&&b.success(g,c.passages[g])},type:"plain/text",error:b.error})},this.getValidReff=function(a){var b=this,a=a||{};return"undefined"==typeof a.level&&(a.level=1),"undefined"!=typeof b.validReffs[a.level]?void("function"==typeof a.success&&a.success(b.validReffs[a.level])):void b.endpoint.getValidReff(b.urn,{inventory:b.inventory,level:a.level,success:function(c){var d=c.getElementsByTagNameNS("*","reff")[0].getElementsByTagNameNS("*","urn");d=[].map.call(d,function(a){return a.childNodes[0].nodeValue});var e={};d.forEach(function(a){var b=a.split(":");e[b[b.length-1]]=a}),b.validReffs[a.level]=e,"function"==typeof a.success&&a.success(e)},type:"text/xml",error:a.error})},this.getLabel=function(a){var c=this,a=a||{};c.endpoint.getLabel(c.urn,{inventory:c.inventory,success:function(d){b.call(c,d),"function"==typeof a.success&&a.success(c)},type:"text/xml",error:a.error})}}}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){"use strict";a.repository={},a.repository.Prototypes={},a.repository.Prototypes.Text=function(a,b,c){if(this.descriptions={},this.titles={},this.urn=this.urn||"",this.citations=[],this.defaultLangDesc,this.defaultLangLabel,this.type=a,this.lang=this.lang||"","undefined"!=typeof b){this.citations=[].map.call(b.getElementsByTagNameNS(c,"citation"),function(a){return a.getAttribute("label")||"Unknown"});for(var d=b.getElementsByTagNameNS(c,"description"),e=d.length-1;e>=0;e--)this.defaultLangDesc=d[e].getAttribute("xml:lang"),this.descriptions[this.defaultLangDesc]=d[e].textContent;for(var f=b.getElementsByTagNameNS(c,"label"),e=f.length-1;e>=0;e--)this.defaultLangLabel=f[e].getAttribute("xml:lang"),this.titles[this.defaultLangLabel]=f[e].textContent}this.getDesc=function(a){if("undefined"===a)a=this.defaultLangDesc;else if(!(a in this.descriptions))return this.descriptions[this.defaultLangDesc];return this.descriptions[a]},this.getTitle=function(a){if("undefined"===a)a=this.defaultLangLabel;else if(!(a in this.titles))return this.titles[this.defaultLangLabel];return this.titles[a]}},a.repository.Prototypes.Work=function(b,c){if(this.titles={},this.urn=this.urn||"",this.defaultLang="",this.lang=this.lang||"",this.editions=[],this.translations=[],this.texts=[],"undefined"!=typeof b){for(var d=b.getElementsByTagNameNS(c,"title"),e=d.length-1;e>=0;e--)this.defaultLang=d[e].getAttribute("xml:lang"),this.titles[this.defaultLang]=d[e].textContent;for(var f=b.getElementsByTagNameNS(c,"edition"),e=f.length-1;e>=0;e--)this.editions.push(new(g(c).Edition)(f[e],this.urn,this.lang));for(var h=b.getElementsByTagNameNS(c,"translation"),e=h.length-1;e>=0;e--)this.translations.push(new(g(c).Translation)(h[e],this.urn));this.texts=this.translations.concat(this.editions)}this.getTitle=function(a){if("undefined"===a)a=this.defaultLang;else if(!(a in this.titles))return this.titles[this.defaultLang];return this.titles[a]},this.toTheoretical=function(){var b=new a.repository.Prototypes.Text;return b.urn=this.urn,b.defaultLangLabel=this.defaultLang,b.titles=this.titles,b.lang=this.lang,b}},a.repository.Prototypes.TextGroup=function(a,b){if(this.titles={},this.urn=this.urn||"",this.defaultLang="",this.works=[],"undefined"!=typeof a){for(var c=a.getElementsByTagNameNS(b,"groupname"),d=c.length-1;d>=0;d--)this.defaultLang=c[d].getAttribute("xml:lang"),this.titles[this.defaultLang]=c[d].textContent;for(var e=a.getElementsByTagNameNS(b,"work"),d=e.length-1;d>=0;d--)this.works.push(new(g(b).Work)(e[d],this.urn))}this.getTitle=function(a){if("undefined"===a)a=this.defaultLang;else if(!(a in this.titles))return this.titles[this.defaultLang];return this.titles[a]}},a.repository.Prototypes.TextInventory=function(a){this.identifier=a,this.namespace="",this.textgroups=[],this.getRaw=function(a,b){"undefined"==typeof b&&(b=!1);var c={};return this.textgroups.forEach(function(d){var e=d.getTitle(a);c[e]={},d.works.forEach(function(d){var f=d.getTitle(a);c[e][f]={edition:{},translation:{}},d.editions.forEach(function(b){c[e][f].edition[b.getTitle(a)]=b}),d.translations.forEach(function(b){c[e][f].translation[b.getTitle(a)]=b}),b===!0&&(c[e][f].theoretical={},c[e][f].theoretical[f]=d.toTheoretical())})}),c}},a.repository.Prototypes.cts3={},a.repository.Prototypes.cts3.Text=function(b,c,d){this.urn=d+"."+b.getAttribute("projid").split(":")[1],a.repository.Prototypes.Text.call(this,c,b,"*")},a.repository.Prototypes.cts3.Text.prototype=Object.create(a.repository.Prototypes.Text.prototype),a.repository.Prototypes.cts3.Edition=function(b,c,d){this.lang=d,a.repository.Prototypes.cts3.Text.call(this,b,"edition",c)},a.repository.Prototypes.cts3.Edition.prototype=Object.create(a.repository.Prototypes.cts3.Text.prototype),a.repository.Prototypes.cts3.Translation=function(b,c){this.lang=b.getAttribute("xml:lang"),a.repository.Prototypes.cts3.Text.call(this,b,"translation",c)},a.repository.Prototypes.cts3.Translation.prototype=Object.create(a.repository.Prototypes.cts3.Text.prototype),a.repository.Prototypes.cts3.Work=function(b,c){this.urn=c+"."+b.getAttribute("projid").split(":")[1],this.lang=b.getAttribute("xml:lang"),a.repository.Prototypes.Work.call(this,b,"*")},a.repository.Prototypes.cts3.Work.prototype=Object.create(a.repository.Prototypes.Work.prototype),a.repository.Prototypes.cts3.TextGroup=function(b){this.urn="urn:cts:"+b.getAttribute("projid"),a.repository.Prototypes.TextGroup.call(this,b,"*")},a.repository.Prototypes.cts3.TextGroup.prototype=Object.create(a.repository.Prototypes.TextGroup.prototype),a.repository.Prototypes.cts3.TextInventory=function(b,c,d){if(a.repository.Prototypes.TextInventory.call(this,d),this.xml=b,this.namespace=c,this.xml=this.xml.getElementsByTagNameNS(this.namespace,"TextInventory"),1==this.xml.length)for(var e=this.xml[0].getElementsByTagNameNS(this.namespace,"textgroup"),f=e.length-1;f>=0;f--)this.textgroups.push(new a.repository.Prototypes.cts3.TextGroup(e[f]))},a.repository.Prototypes.cts3.TextInventory.prototype=Object.create(a.repository.Prototypes.TextInventory.prototype),a.repository.Prototypes.cts5={},a.repository.Prototypes.cts5.Text=function(b,c){this.urn=b.getAttribute("urn"),a.repository.Prototypes.Text.call(this,c,b,"http://chs.harvard.edu/xmlns/cts")},a.repository.Prototypes.cts5.Text.prototype=Object.create(a.repository.Prototypes.Text.prototype),a.repository.Prototypes.cts5.Edition=function(b,c,d){this.lang=d,a.repository.Prototypes.cts5.Text.call(this,b,"edition",c)},a.repository.Prototypes.cts5.Edition.prototype=Object.create(a.repository.Prototypes.cts5.Text.prototype),a.repository.Prototypes.cts5.Translation=function(b,c){this.lang=b.getAttribute("xml:lang"),a.repository.Prototypes.cts5.Text.call(this,b,"translation",c)},a.repository.Prototypes.cts5.Translation.prototype=Object.create(a.repository.Prototypes.cts5.Text.prototype),a.repository.Prototypes.cts5.Work=function(b){this.urn=b.getAttribute("urn"),this.lang=b.getAttribute("xml:lang"),a.repository.Prototypes.Work.call(this,b,"http://chs.harvard.edu/xmlns/cts")},a.repository.Prototypes.cts5.Work.prototype=Object.create(a.repository.Prototypes.Work.prototype),a.repository.Prototypes.cts5.TextGroup=function(b){this.urn=b.getAttribute("urn"),a.repository.Prototypes.TextGroup.call(this,b,"http://chs.harvard.edu/xmlns/cts")},a.repository.Prototypes.cts5.TextGroup.prototype=Object.create(a.repository.Prototypes.TextGroup.prototype),a.repository.Prototypes.cts5.TextInventory=function(b,c,d){if(a.repository.Prototypes.TextInventory.call(this,d),this.xml=b,this.namespace=c||"http://chs.harvard.edu/xmlns/cts",this.xml=this.xml.getElementsByTagNameNS(this.namespace,"TextInventory"),1==this.xml.length)for(var e=this.xml[0].getElementsByTagNameNS(this.namespace,"textgroup"),f=e.length-1;f>=0;f--)this.textgroups.push(new a.repository.Prototypes.cts5.TextGroup(e[f]))},a.repository.Prototypes.cts5.TextInventory.prototype=Object.create(a.repository.Prototypes.TextInventory.prototype);var b=function(a){"string"==typeof a?this.endpoint=[a]:"array"==typeof a&&(this.endpoint=a)},c=function(a){this.inventory=a},d=function(a,b){if("string"!=typeof a)throw"Name is not a string";this.inventory[a]="undefined"==typeof b?a:b},e=function(a){if(!("string"==typeof a&&a in self.inventory))throw a+" is not in known inventories.";delete this.inventory[a]},f=function(b,c,d){var e=(this.endpoint,a.utils.xhr,this);if("undefined"==typeof d)var d=Object.keys(this.inventory);if("function"!=typeof b)var b=null;if("function"!=typeof c)var c=function(){};return this.endpoint.getCapabilities(d[0],{success:function(a){e.inventories[d[0]]=new e.TextInventory(a,e.namespace,d[0]),1===d.length?null!==b&&b():(d.shift(),e.load(b,c,d))},error:c,type:"text/xml"}),this};a.repository.repository=function(g,h,i){("undefined"==typeof h||3!==h&&5!==h)&&(h=3),this.namespace="undefined"==typeof i?3===h?"http://chs.harvard.edu/xmlns/cts3/ti":"http://chs.harvard.edu/xmlns/cts":i,this.version=h,this.endpoint=a.utils.checkEndpoint(g),this.inventories={},this.inventory={},this.setEndpoint=b,this.addInventory=d,this.setInventory=c,this.delInventory=e,this.load=f,this.fromObject=function(b){var c=this;Object.keys(b).forEach(function(d){c.inventories[d]=a.repository.helpers.TextInventory(b[d]),c.inventory[d]=d})},this.TextInventory=a.repository.Prototypes["cts"+this.version].TextInventory},a.repository.helpers={},a.repository.helpers.Text=function(b){var c=new a.repository.Prototypes.Text;return Object.keys(b).forEach(function(a){c[a]=b[a]}),c},a.repository.helpers.Work=function(b){var c=new a.repository.Prototypes.Work;return Object.keys(b).forEach(function(d){c[d]="editions"===d||"translations"===d||"texts"===d?b[d].map(function(b){return a.repository.helpers.Text(b)}):b[d]}),c},a.repository.helpers.TextGroup=function(b){var c=new a.repository.Prototypes.TextGroup;return Object.keys(b).forEach(function(d){"works"!==d?c[d]=b[d]:c.works=b.works.map(function(b){return a.repository.helpers.Work(b)})}),c},a.repository.helpers.TextInventory=function(b){var c=new a.repository.Prototypes.TextInventory;return Object.keys(b).forEach(function(d){"textgroups"!==d?c[d]=b[d]:c.textgroups=b.textgroups.map(function(b){return a.repository.helpers.TextGroup(b)})}),c};var g=function(b){return"http://chs.harvard.edu/xmlns/cts"===b?a.repository.Prototypes.cts5:a.repository.Prototypes.cts3}}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){"use strict";var b=function(b,c){return"undefined"!=typeof c&&c in a.lang.lexicons||(c="en"),b in a.lang.lexicons[c]?a.lang.lexicons[c][b]:a.lang.lexicons.en[b]};a.lang={get:b,lexicons:{}}}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.service.services["llt.tokenizer"]=function(b,c){a.service._service.call(this,b,c),this.method="POST",this.options={xml:{type:"boolean",html:"checkbox","default":!1},inline:{type:"boolean",html:"hidden","default":!0},splitting:{type:"boolean",html:"checkbox","default":!0},merging:{type:"boolean",html:"checkbox","default":!1},shifting:{type:"boolean",html:"checkbox","default":!1},text:{type:"text",html:"textarea"},remove_node:{type:"list",html:"input","default":["teiHeader","head","speaker","note","ref"]},go_to_root:{type:"string",html:"input","default":"TEI"},ns:{type:"string",html:"input","default":"http://www.tei-c.org/ns/1.0"}}},a.service.services["llt.tokenizer"].prototype=Object.create(a.service._service)}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.endpoint.simpleUrl=function(b,c){a.endpoint.Endpoint.call(this),this.url=b,this.inventory="undefined"!=typeof c?c:null,this.getUrl=function(){return this.url},this.getCapabilitiesURL=function(){return this.getUrl()},this.getCapabilities=function(a,b){this.getRequest(this.url,b)},this.getPassageURL=function(){return this.getUrl()},this.getPassage=function(a,b){this.getRequest(this.url,b)},this.getValidReffURL=function(){return this.getUrl()},this.getValidReff=function(a,b){this.getRequest(this.url,b)}},a.endpoint.simpleUrl.prototype=Object.create(a.endpoint.Endpoint)}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.xslt.stylesheets["cts.passage_to_text"]=function(b,c){a.xslt.XSLT.call(this,b,c),this.options={}},a.xslt.stylesheets["cts.passage_to_text"].prototype=Object.create(a.xslt.XSLT)}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.xslt.stylesheets["llt.segtok_to_align"]=function(b,c){a.xslt.XSLT.call(this,b,c),this.options={e_lang:{type:"string",html:"hidden","default":"lat"},e_dir:{type:"string",html:"hidden","default":"ltr"},e_lnum:{type:"string",html:"hidden","default":"l1"},e_docuri:{type:"string",html:"hidden","default":""},e_agenturi:{type:"string",html:"hidden","default":"http://services.perseids.org/llt/segtok"},e_appuri:{type:"string",html:"hidden","default":""},e_datetime:{type:"string",html:"hidden","default":function(){return(new Date).toDateString()}},e_includepunc:{type:"boolean",html:"checkbox","default":!0},e_mergesentences:{type:"boolean",html:"checkbox","default":!0},e_collection:{type:"string",html:"hidden","default":"urn:cite:perseus:align"},e_title:{type:"string",html:"hidden","default":""}}},a.xslt.stylesheets["llt.segtok_to_align"].prototype=Object.create(a.xslt.XSLT)}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){a.xslt.stylesheets["llt.segtok_to_tb"]=function(b,c){a.xslt.XSLT.call(this,b,c),this.options={e_lang:{type:"string",html:"input","default":"lat"},e_format:{type:"string",html:"input","default":"aldt"},e_docuri:{type:"string",html:"input","default":""},e_agenturi:{type:"string",html:"input","default":"http://services.perseids.org/llt/segtok"},e_appuri:{type:"string",html:"input","default":""},e_datetime:{type:"string",html:"hidden","default":function(){return(new Date).toDateString()}},e_collection:{type:"string",html:"input","default":"urn:cite:perseus:lattb"},e_attachtoroot:{type:"boolean",html:"checkbox","default":!1}}},a.xslt.stylesheets["llt.segtok_to_tb"].prototype=Object.create(a.xslt.XSLT)}),function(a){"function"==typeof define&&define.amd?define(["cts"],a):a(CTS)}(function(a){"use strict";var b={translation:"Translation",edition:"Edition",theoretical:"Theoretical Work",select:"Select",start_passage:"Beginning of passage",stop_passage:"End of passage",retrieve_passage:"Retrieve passage",loading:"Loading...","llt.tokenizer":"Tokenizer parameters","llt.tokenizer.xml":"XML Formatted input","llt.tokenizer.inline":"?","llt.tokenizer.splitting":"Split Enclytics","llt.tokenizer.merging":"Merge split words","llt.tokenizer.shifting":"Shift Enclytics","llt.tokenizer.text":"Text to tokenize","llt.tokenizer.remove_node":"Nodes to remove from XML","llt.tokenizer.go_to_root":"Name of the root node","llt.tokenizer.ns":"Namespace of the XML","llt.segtok_to_tb":"Treebank Parameters","llt.segtok_to_tb.e_lang":"Language","llt.segtok_to_tb.e_format":"Treebank grammar","llt.segtok_to_tb.e_docuri":"Document URI","llt.segtok_to_tb.e_agenturi":"Agent URI","llt.segtok_to_tb.e_appuri":"Application URI","llt.segtok_to_tb.e_datetime":"Date","llt.segtok_to_tb.e_collection":"Collection","llt.segtok_to_tb.e_attachtoroot":"Attach to the root","llt.segtok_to_align.e_docuri":"Document URI","llt.segtok_to_align.e_appuri":"Application URI","llt.segtok_to_align.e_datetime":"Date","llt.segtok_to_align.e_agenturi":"Agent URI","llt.segtok_to_align.e_lang":"Language Code","llt.segtok_to_align.e_ldir":"Text Direction","llt.segtok_to_align.e_lnum":"Language Number","llt.segtok_to_align.e_mergesentences":"Align as Single Chunk","llt.segtok_to_align.e_includepunc":"Include Punctuation"};a.lang.lexicons.en=b});
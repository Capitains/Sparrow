var CTS=function(a){"use strict";function a(){return{}}return new a}(CTS),CTS=function(a){"use strict";function b(a,b){var f={};return"undefined"==typeof b&&(f.namespace=3===a?"http://chs.harvard.edu/xmlns/cts3/ti":"http://chs.harvard.edu/xmlns/cts"),f.version=a,f.url=[],f.data=[],f.setUrl=d,f.load=e,f.xhr=c,3===f.version?f.TextInventory=i:f.Repository=null,f}var c=function(a,b,c,d){var e;if("undefined"==typeof d&&(d=!0),window&&window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window||!window.ActiveXObject)return null;var f,g;if(window.ActiveXObject){f=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(g in f)try{return new ActiveXObject(f[g])}catch(h){}}}try{e.open(a,b,d),e.onreadystatechange=function(){4===e.readyState&&"function"==typeof c&&c(e.responseXML)},e.send()}catch(i){console.error(i)}},d=function(a){"string"==typeof a?this.url=[a]:"array"==typeof a&&(this.url=a)},e=function(a,b){var a,b,c=(this.xhr,this);if("function"==typeof a)var b=a,a=this.url;else if("undefined"==typeof a&&"undefined"==typeof b)var a=this.url;if("string"==typeof a)var a=[a];return this.xhr("GET",a[0],function(d){c.data.push(new c.TextInventory(d,c.namespace,a[0])),1===a.length?b():(a.shift(),this.load(a,b))}),this},f=function(a,b,c){var d={};return d.type=b,d.descriptions={},d.urn=c+"."+a.getAttribute("projid").split(":")[1],[].map.call(a.getElementsByTagName("description"),function(a){d.defaultLang=a.getAttribute("xml:lang"),d.descriptions[d.defaultLang]=a.textContent}),d.getDesc=function(a){if("undefined"===a)a=this.defaultLang;else if(!(a in this.descriptions))return this.descriptions[this.defaultLang];return this.descriptions[a]},d},g=function(a,b){var c={};return c.label={},c.urn=b+"."+a.getAttribute("projid").split(":")[1],[].map.call(a.getElementsByTagName("title"),function(a){c.defaultLang=a.getAttribute("xml:lang"),c.label[c.defaultLang]=a.textContent}),c.getTitle=function(a){if("undefined"===a)a=this.defaultLang;else if(!(a in this.label))return this.label[this.defaultLang];return this.label[a]},c._Translation=function(a){return f(a,"translation",c.urn)},c._Edition=function(a){return f(a,"edition",c.urn)},c.editions=[].map.call(a.getElementsByTagName("edition"),c._Edition),c.translations=[].map.call(a.getElementsByTagName("translation"),c._Translation),c.texts=c.translations.concat(c.editions),c},h=function(a){var b={};return b.label={},b.urn=a.getAttribute("projid"),[].map.call(a.getElementsByTagName("groupname"),function(a){b.defaultLang=a.getAttribute("xml:lang"),b.label[b.defaultLang]=a.textContent}),b.getName=function(a){if("undefined"===a)a=this.defaultLang;else if(!(a in this.label))return this.label[this.defaultLang];return this.label[a]},b._Work=g,b.works=[].map.call(a.getElementsByTagName("work"),function(a){return b._Work(a,b.urn)}),b},i=function(a,b,c){var d,e={};return e.identifier=c,e.namespace=b,d=a.getElementsByTagNameNS(e.namespace,"TextInventory"),e._TextGroup=h,e.textgroups=1==d.length?[].map.call(d[0].getElementsByTagNameNS(e.namespace,"textgroup"),e._TextGroup):[],e.getRaw=function(a){var b={};return e.textgroups.forEach(function(c){var d=c.getName(a);b[d]={},c.works.forEach(function(c){var e=c.getTitle(a);b[d][e]={editions:{},translations:{}},c.editions.forEach(function(c){b[d][e].editions[c.getDesc(a)]=c.urn}),c.translations.forEach(function(c){b[d][e].translations[c.getDesc(a)]=c.urn})})}),b},e};return a.repository=b,a}(CTS);